<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Anime Store ‚Äî –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Ñ–∏–≥—É—Ä–æ–∫</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />

  <style>
    /* =======================
       1) Variables / Themes
    ======================== */
    :root{
      --accent: #8b5cf6;
      --accent-2: #7c3aed;

      --header-bg: #111;
      --nav-bg: #222;

      --bg-overlay: linear-gradient(rgba(0,0,0,0.65), rgba(0,0,0,0.85));
      --text-main: #f3f3f3;
      --card-bg: rgba(25,25,25,0.95);

      --shadow: 0 10px 30px rgba(0,0,0,0.18);
      --radius: 14px;
    }

    body.light{
      --bg-overlay: linear-gradient(rgba(255,255,255,0.65), rgba(255,255,255,0.85));
      --text-main: #111;
      --card-bg: #ffffff;
    }
    body.dark{
      --bg-overlay: linear-gradient(rgba(0,0,0,0.65), rgba(0,0,0,0.85));
      --text-main: #f3f3f3;
      --card-bg: rgba(25,25,25,0.95);
    }

    /* =======================
       2) Base
    ======================== */
    *{ box-sizing: border-box; }
    html, body{ width: 100%; overflow-x: hidden; }
    body{
      font-family: Arial, sans-serif;
      margin: 0;
      color: var(--text-main);
    }

    body::before{
      content: "";
      position: fixed;
      inset: 0;
      background:
        var(--bg-overlay),
        url("https://i.pinimg.com/736x/9f/79/63/9f796349f7fff04530cf20b146dd10da.jpg")
        center / cover no-repeat;
      z-index: -1;
    }

    /* smooth */
    body, header, nav, .container, .btn, .accent, .badge, .feature, .card, .orderCard{
      transition: background-color .25s ease, color .25s ease, border-color .25s ease, box-shadow .25s ease, transform .25s ease;
    }

    header{
      background: var(--header-bg);
      color: #fff;
      padding: 18px 14px;
      text-align: center;
    }

    nav{
      background: var(--nav-bg);
      display: flex;
      justify-content: center;
      gap: 10px;
      padding: 6px;
      flex-wrap: wrap;
    }

    nav button{
      background: none;
      border: none;
      color: #fff;
      padding: 12px 18px;
      cursor: pointer;
      font-size: 16px;
      position: relative;
      border-radius: 10px;
      transition: background .2s ease, color .2s ease;
    }
    nav button:hover{ background: rgba(255,255,255,0.12); }
    nav button.activeTab{ background: rgba(255,255,255,0.16); }

    nav button::after{
      content:"";
      position:absolute;
      left: 20%;
      bottom: 6px;
      width: 60%;
      height: 2px;
      opacity: 0;
      transform: scaleX(0);
      background: var(--accent);
      transition: .25s ease;
      border-radius: 999px;
    }
    nav button:hover::after{
      opacity: 1;
      transform: scaleX(1);
    }

    .navRight{
      margin-left: auto;
      background: rgba(255,255,255,0.10);
    }

    .container{
      margin: 16px auto 0;
      width: min(1100px, calc(100% - 24px));
      padding: 18px;
      min-height: 60vh;
      position: relative;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
    }

    /* tabs animation */
    .page{
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      opacity: 0;
      transform: translateY(12px);
      pointer-events: none;
      transition: opacity .35s ease, transform .35s ease;
    }
    .page.active{
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
      position: relative;
    }

    footer{
      background: #111;
      color: #fff;
      text-align: center;
      padding: 15px;
      margin-top: 30px;
    }

    /* =======================
       3) UI elements
    ======================== */
    .btn{
      padding: 10px 16px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      background: var(--accent);
      color: #fff;
      transition: transform .2s ease, box-shadow .2s ease, background .2s ease;
    }
    .btn:hover{
      background: var(--accent-2);
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }
    .btn.ghost{
      background: rgba(255,255,255,0.14);
      color: inherit;
      border: 1px solid rgba(255,255,255,0.18);
      box-shadow: none;
    }
    body.light .btn.ghost{
      background: rgba(0,0,0,0.06);
      border-color: rgba(0,0,0,0.12);
    }

    .accent{
      color: #fff;
      background: var(--accent);
      padding: 2px 10px;
      border-radius: 999px;
    }

    /* =======================
       4) Home / Hero
    ======================== */
    .hero{
      display: grid;
      grid-template-columns: 1.2fr .8fr;
      gap: 24px;
      align-items: start;
    }
    .hero-text{
      font-size: 16px;
      line-height: 1.55;
      margin-top: 10px;
      max-width: 560px;
      opacity: .95;
    }
    .hero-actions{
      margin-top: 18px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .badges{
      margin-top: 14px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .badge{
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 13px;
    }
    body.light .badge{
      background: rgba(0,0,0,0.06);
      border-color: rgba(0,0,0,0.12);
    }

    .hero-card{
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 18px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    body.light .hero-card{
      background: rgba(0,0,0,0.05);
      border-color: rgba(0,0,0,0.10);
    }

    .mini-grid{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .mini{
      display: flex;
      gap: 10px;
      align-items: center;
      padding: 10px;
      border-radius: 14px;
      background: rgba(255,255,255,0.10);
      cursor: pointer;
    }
    body.light .mini{ background: rgba(0,0,0,0.06); }
    .mini:hover{ transform: translateY(-2px); }
    .mini img{
      width: 46px;
      height: 46px;
      border-radius: 12px;
      object-fit: cover;
    }
    .mini small{ display: block; opacity: .75; margin-top: 2px; }

    .miniBtn{ width: 100%; margin-top: 12px; }

    .features{
      margin-top: 22px;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }
    .feature{
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
      border-radius: 16px;
      padding: 14px;
    }
    body.light .feature{
      background: rgba(0,0,0,0.05);
      border-color: rgba(0,0,0,0.10);
    }
    .feature p{ margin: 0; opacity: .9; font-size: 14px; line-height: 1.45; }

    /* =======================
       5) Catalog / Cards
    ======================== */
    .catalog{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 14px;
      align-items: stretch;

      
    }
    .card{
  width: auto;
}
    .card{
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
      padding: 15px;
      width: 200px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.12);
      text-align: center;
      cursor: pointer;
    }
    body.light .card{
      background: #fff;
      border-color: rgba(0,0,0,0.10);
    }
    .card:hover{
      transform: translateY(-6px) scale(1.03);
      box-shadow: 0 12px 30px rgba(0,0,0,0.18);
    }
    .card img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 10px;
    }

    /* =======================
       6) Product
    ======================== */
    #product img{
      max-width: 320px;
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.18);
      margin-bottom: 15px;
    }

    /* =======================
       7) Cart
    ======================== */
    #cart-list{
      list-style: none;
      padding: 0;
      margin: 0;
      display: grid;
      gap: 10px;
    }
    #cart-list li{
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
      padding: 10px;
      border-radius: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    body.light #cart-list li{
      background: #fff;
      border-color: rgba(0,0,0,0.10);
    }
    .cart-actions{
      margin-top: 12px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .removeItemBtn{
      border: none;
      border-radius: 10px;
      padding: 6px 10px;
      cursor: pointer;
      background: rgba(239,68,68,0.16);
      color: #ef4444;
      font-weight: 700;
    }
    body.light .removeItemBtn{
      background: rgba(239,68,68,0.10);
    }

    /* =======================
       8) Orders
    ======================== */
    #ordersList{ margin: 16px 0; display: grid; gap: 12px; }

    .orderCard{
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.18);
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 0 10px rgba(0,0,0,0.10);
    }
    body.light .orderCard{
      background: #fff;
      border-color: rgba(0,0,0,0.10);
    }
    .orderHead{
      display:flex;
      justify-content: space-between;
      gap: 12px;
      align-items: center;
    }
    .orderItems{
      margin-top: 8px;
      opacity: .95;
      font-size: 14px;
      line-height: 1.45;
    }
    .orderMeta{
      margin-top: 8px;
      opacity: .85;
      font-size: 13px;
      line-height: 1.5;
    }
    .orderActions{
      margin-top: 10px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    .dangerBtn{
      background: rgba(239,68,68,0.18);
      color: #ef4444;
    }
    .dangerBtn:hover{
      background: rgba(239,68,68,0.28);
    }

    /* =======================
       9) Theme switch panel
    ======================== */
    .theme-switch{
      position: fixed;
      right: 16px;
      bottom: 16px;
      z-index: 9998;
      background: rgba(255,255,255,0.75);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.35);
      padding: 10px 12px;
      border-radius: 16px;
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      gap: 10px;
      color: #111;
      max-width: calc(100vw - 24px);
    }
    .theme-dots{ display:flex; gap: 8px; }
    .theme-dot{
      width: 16px; height: 16px;
      border-radius: 999px;
      border: 2px solid rgba(0,0,0,0.15);
      cursor: pointer;
    }
    .theme-dot.red{ background: #ef4444; }
    .theme-dot.blue{ background: #3b82f6; }
    .theme-dot.orange{ background: #f97316; }
    .theme-dot.purple{ background: #8b5cf6; }

    .mode-btn{
      margin-left: 6px;
      padding: 6px 10px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      font-size: 16px;
      background: rgba(0,0,0,0.15);
    }

    /* =======================
       10) Loader
    ======================== */
    #loader{
      position: fixed;
      inset: 0;
      background:
        linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)),
        url("https://i.pinimg.com/1200x/d9/41/23/d94123a5ed0203b5c46b2666aea14fde.jpg") center / cover no-repeat;
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: opacity .6s ease, visibility .6s ease;
    }
    #loader.hide{ opacity: 0; visibility: hidden; }

    .loader-content{ text-align: center; color: white; }
    .spinner{
      width: 70px; height: 70px;
      border: 4px solid rgba(255,255,255,.2);
      border-top: 4px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }
    @keyframes spin{ to { transform: rotate(360deg); } }

    /* =======================
       11) Modals (Auth / Pay)
    ======================== */
    .overlay{
      position: fixed;
      inset: 0;
      z-index: 10000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      background: rgba(0,0,0,0.65);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    .overlay.show{ display: flex; }

    .modalBox{
      width: 100%;
      max-width: 560px;
      border-radius: 18px;
      padding: 18px;
      background: rgba(255,255,255,0.92);
      box-shadow: 0 20px 60px rgba(0,0,0,0.35);
      color: #111;
    }
    body.dark .modalBox{
      background: rgba(20,20,20,0.92);
      color: #f3f3f3;
    }

    .modalHeader{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 12px;
    }
    .modalHeader h3{ margin:0; }
    .modalHeader small{ opacity:.7; }

    .row{ margin-top: 10px; }
    .row label{ display:block; font-size: 13px; opacity:.85; margin-bottom:6px; }

    .row input, .row select{
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,0.15);
      outline: none;
      font-size: 14px;
    }
    body.dark .row input, body.dark .row select{
      background: rgba(0,0,0,0.25);
      border-color: rgba(255,255,255,0.18);
      color: #fff;
    }

    .grid2{
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }

    .chips{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
    }
    .chip{
      display:flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,0.06);
      cursor:pointer;
      user-select:none;
    }
    body.dark .chip{ background: rgba(255,255,255,0.08); }

    .sumBox{
      margin: 10px 0 14px;
      padding: 10px 12px;
      border-radius: 12px;
      background: rgba(0,0,0,0.06);
    }
    body.dark .sumBox{ background: rgba(255,255,255,0.08); }

    .sumLine{
      display:flex;
      justify-content: space-between;
      gap: 10px;
      margin: 6px 0;
    }

    .actions{
      margin-top: 14px;
      display:flex;
      gap:10px;
      justify-content:flex-end;
      flex-wrap:wrap;
    }

    .hint{ margin-top: 6px; font-size: 12px; opacity: .75; }

    .error{
      margin-top: 10px;
      color: #ef4444;
      font-size: 13px;
      display:none;
    }
    .error.show{ display:block; }

    /* =======================
       12) Responsive
    ======================== */
    @media (max-width: 900px){
      .hero{ grid-template-columns: 1fr; }
      .features{ grid-template-columns: 1fr; }
    }
    @media (max-width: 600px){
      header{ padding: 14px 12px; }
      header h1{ margin: 0; font-size: 22px; }
      nav button{ padding: 10px 12px; font-size: 14px; }
      .container{ padding: 14px; }

      .catalog{ gap: 12px; }
      .card{ width: calc(50% - 6px); padding: 12px; }
    }
    @media (max-width: 420px){
      .card{ width: 100%; }
    }
  </style>
</head>

<body>

  <!-- Loader -->
  <div id="loader">
    <div class="loader-content">
      <div class="spinner"></div>
      <h1>Anime Store</h1>
      <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
    </div>
  </div>

  <!-- AUTH -->
  <div id="authOverlay" class="overlay">
    <div class="modalBox">
      <div class="modalHeader">
        <div>
          <h3>–í—Ö–æ–¥ –≤ Anime Store</h3>
          <small>–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å</small>
        </div>
        <button class="btn ghost" type="button" onclick="logout()" title="–°–±—Ä–æ—Å–∏—Ç—å –≤—Ö–æ–¥">‚Ü∫</button>
      </div>

      <div class="row">
        <label for="authLogin">–õ–æ–≥–∏–Ω</label>
        <input id="authLogin" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: admin" />
      </div>

      <div class="row">
        <label for="authPass">–ü–∞—Ä–æ–ª—å</label>
        <input id="authPass" type="password" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 1234" />
      </div>

      <div class="actions" style="justify-content:flex-start;">
        <button class="btn" type="button" onclick="login()">–í–æ–π—Ç–∏</button>
        <button class="btn ghost" type="button" onclick="fillDemo()">–î–µ–º–æ</button>
      </div>

      <div id="authError" class="error">–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å.</div>
      <div class="hint">*–≠—Ç–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞). –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–π ‚Äî –Ω—É–∂–µ–Ω backend.</div>
    </div>
  </div>

  <!-- Theme Switch -->
  <div class="theme-switch">
    <b>–¢–µ–º–∞:</b>
    <div class="theme-dots">
      <button class="theme-dot red" type="button" aria-label="–ö—Ä–∞—Å–Ω–∞—è" onclick="setTheme('red')"></button>
      <button class="theme-dot blue" type="button" aria-label="–°–∏–Ω—è—è" onclick="setTheme('blue')"></button>
      <button class="theme-dot orange" type="button" aria-label="–û—Ä–∞–Ω–∂–µ–≤–∞—è" onclick="setTheme('orange')"></button>
      <button class="theme-dot purple" type="button" aria-label="–§–∏–æ–ª–µ—Ç–æ–≤–∞—è" onclick="setTheme('purple')"></button>
    </div>
    <button class="mode-btn" type="button" onclick="toggleMode()">üåô</button>
  </div>

  <header>
    <h1 style="margin:0;">Anime Store</h1>
    <p style="margin:6px 0 0;">–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –∞–Ω–∏–º–µ —Ñ–∏–≥—É—Ä–æ–∫</p>
  </header>

  <nav>
    <button onclick="showPage('home')">–ì–ª–∞–≤–Ω–∞—è</button>
    <button onclick="showPage('catalogPage')">–ö–∞—Ç–∞–ª–æ–≥</button>
    <button onclick="showPage('cart')">–ö–æ—Ä–∑–∏–Ω–∞</button>
    <button onclick="showPage('about')">–û –Ω–∞—Å</button>
    <button onclick="showPage('orders')">–ó–∞–∫–∞–∑—ã</button>
    <button class="navRight" onclick="logout()" title="–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞">–í—ã–π—Ç–∏</button>
  </nav>

  <div class="container">

    <!-- HOME -->
    <div id="home" class="page active">
      <section class="hero">
        <div class="hero-left">
          <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <span class="accent">Anime Store</span>!</h2>
          <p class="hero-text">
            –ú–∞–≥–∞–∑–∏–Ω –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∞–Ω–∏–º–µ-—Ñ–∏–≥—É—Ä–æ–∫: –∫—É–ª—å—Ç–æ–≤—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è
            –∏ –∫—Ä—É—Ç—ã–µ –ø–æ–¥–∞—Ä–∫–∏ –¥–ª—è —Ñ–∞–Ω–∞—Ç–æ–≤.
          </p>

          <div class="hero-actions">
            <button class="btn" onclick="showPage('catalogPage')">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥</button>
            <button class="btn ghost" onclick="showPage('about')">–û –º–∞–≥–∞–∑–∏–Ω–µ</button>
          </div>

          <div class="badges">
            <span class="badge">–ì–ª–∞–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</span>
            <span class="badge">‚≠ê –ö–∞—á–µ—Å—Ç–≤–æ</span>
            <span class="badge">üì¶ –£–ø–∞–∫–æ–≤–∫–∞</span>
            <span class="badge">üöö –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</span>
            <span class="badge">üéÅ –ò–¥–µ—è –¥–ª—è –ø–æ–¥–∞—Ä–∫–∞</span>
          </div>
        </div>

        <div class="hero-right">
          <div class="hero-card">
            <h3 style="margin:0 0 6px;">–¢–æ–ø-–ø–æ–ø—É–ª—è—Ä–Ω–æ–µ</h3>
            <p style="margin:0 0 14px; opacity:.85;">–ù–∞–∂–º–∏ –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞.</p>

            <div class="mini-grid">
              <div class="mini" onclick="openProduct('Naruto','https://i.pinimg.com/736x/de/97/79/de9779f6bcb1772a7e46e09c252052c8.jpg','–§–∏–≥—É—Ä–∫–∞ –ù–∞—Ä—É—Ç–æ –£–∑—É–º–∞–∫–∏ –∏–∑ –∞–Ω–∏–º–µ Naruto.','2500 ‚ÇΩ')">
                <img src="https://i.pinimg.com/736x/de/97/79/de9779f6bcb1772a7e46e09c252052c8.jpg" alt="Naruto">
                <div><b>Naruto</b><small>2500 ‚ÇΩ</small></div>
              </div>

              <div class="mini" onclick="openProduct('Gojo Satoru','https://i.pinimg.com/736x/4b/a8/7c/4ba87cc0815a34837d21f560bcfcb694.jpg','–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω–∞—è —Ñ–∏–≥—É—Ä–∫–∞ –∏–∑ –∞–Ω–∏–º–µ ¬´Jujutsu Kaisen¬ª.','3200 ‚ÇΩ')">
                <img src="https://i.pinimg.com/736x/4b/a8/7c/4ba87cc0815a34837d21f560bcfcb694.jpg" alt="Gojo">
                <div><b>Gojo</b><small>3200 ‚ÇΩ</small></div>
              </div>

              <div class="mini" onclick="openProduct('Luffy','https://i.pinimg.com/1200x/2d/0f/6f/2d0f6f2e5e09cac2448aad5bb55d48d8.jpg','–§–∏–≥—É—Ä–∫–∞ –ú–æ–Ω–∫–∏ –î. –õ—É—Ñ—Ñ–∏ –∏–∑ One Piece.','2800 ‚ÇΩ')">
                <img src="https://i.pinimg.com/1200x/2d/0f/6f/2d0f6f2e5e09cac2448aad5bb55d48d8.jpg" alt="Luffy">
                <div><b>Luffy</b><small>2800 ‚ÇΩ</small></div>
              </div>

              <div class="mini" onclick="openProduct('Eren Yeager','https://i.pinimg.com/1200x/3c/cc/1d/3ccc1dc40eb3a8310994e512b0583210.jpg','–§–∏–≥—É—Ä–∫–∞ –≠—Ä–µ–Ω–∞ –ô–µ–≥–µ—Ä–∞ –∏–∑ ¬´–ê—Ç–∞–∫–∏ —Ç–∏—Ç–∞–Ω–æ–≤¬ª.','3000 ‚ÇΩ')">
                <img src="https://i.pinimg.com/1200x/3c/cc/1d/3ccc1dc40eb3a8310994e512b0583210.jpg" alt="Eren">
                <div><b>Eren</b><small>3000 ‚ÇΩ</small></div>
              </div>
            </div>

            <button class="btn miniBtn" onclick="showPage('catalogPage')">–°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã</button>
          </div>
        </div>
      </section>

      <section class="features">
        <div class="feature">
          <h4 style="margin:0 0 6px;">üõ°Ô∏è –ù–∞–¥—ë–∂–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞</h4>
          <p>–§–∏–≥—É—Ä–∫–∏ –ø—Ä–∏–µ–∑–∂–∞—é—Ç —Ü–µ–ª—ã–º–∏: –∑–∞—â–∏—Ç–∞, –ø—É–ø—ã—Ä–∫–∞, –∞–∫–∫—É—Ä–∞—Ç–Ω–∞—è –∫–æ—Ä–æ–±–∫–∞.</p>
        </div>
        <div class="feature">
          <h4 style="margin:0 0 6px;">‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –∏ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è</h4>
          <p>–¢—â–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–±–∏—Ä–∞–µ–º –º–æ–¥–µ–ª–∏, —á—Ç–æ–±—ã –æ–Ω–∏ –≤—ã–≥–ª—è–¥–µ–ª–∏ –∫–∞–∫ –≤ –∞–Ω–∏–º–µ.</p>
        </div>
        <div class="feature">
          <h4 style="margin:0 0 6px;">üéÅ –ü–æ–¥–∞—Ä–∫–∏ —Ñ–∞–Ω–∞—Ç–∞–º</h4>
          <p>–ò–¥–µ–∞–ª—å–Ω–æ –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è, –Ω–æ–≤—ã–π –≥–æ–¥ –∏ –ø—Ä–æ—Å—Ç–æ ‚Äú–ø–æ—Ä–∞–¥–æ–≤–∞—Ç—å —Å–µ–±—è‚Äù.</p>
        </div>
      </section>
    </div>

    <!-- CATALOG -->
    <div id="catalogPage" class="page">
      <h2>–ö–∞—Ç–∞–ª–æ–≥</h2>
      <div class="catalog">
        <div class="card" onclick="openProduct('Naruto','https://i.pinimg.com/736x/de/97/79/de9779f6bcb1772a7e46e09c252052c8.jpg','–§–∏–≥—É—Ä–∫–∞ –ù–∞—Ä—É—Ç–æ –£–∑—É–º–∞–∫–∏ –∏–∑ –∞–Ω–∏–º–µ Naruto.','2500 ‚ÇΩ')">
          <img src="https://i.pinimg.com/736x/de/97/79/de9779f6bcb1772a7e46e09c252052c8.jpg" alt="Naruto">
          <h3>Naruto</h3><p>–¶–µ–Ω–∞: 2500 ‚ÇΩ</p>
        </div>

        <div class="card" onclick="openProduct('Gojo Satoru','https://i.pinimg.com/736x/4b/a8/7c/4ba87cc0815a34837d21f560bcfcb694.jpg','–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω–∞—è —Ñ–∏–≥—É—Ä–∫–∞ –∏–∑ –∞–Ω–∏–º–µ ¬´Jujutsu Kaisen¬ª.','3200 ‚ÇΩ')">
          <img src="https://i.pinimg.com/736x/4b/a8/7c/4ba87cc0815a34837d21f560bcfcb694.jpg" alt="Gojo Satoru">
          <h3>Gojo Satoru</h3><p>–¶–µ–Ω–∞: 3200 ‚ÇΩ</p>
        </div>

        <div class="card" onclick="openProduct('Luffy','https://i.pinimg.com/1200x/2d/0f/6f/2d0f6f2e5e09cac2448aad5bb55d48d8.jpg','–§–∏–≥—É—Ä–∫–∞ –ú–æ–Ω–∫–∏ –î. –õ—É—Ñ—Ñ–∏ –∏–∑ One Piece.','2800 ‚ÇΩ')">
          <img src="https://i.pinimg.com/1200x/2d/0f/6f/2d0f6f2e5e09cac2448aad5bb55d48d8.jpg" alt="Luffy">
          <h3>Luffy</h3><p>–¶–µ–Ω–∞: 2800 ‚ÇΩ</p>
        </div>

        <div class="card" onclick="openProduct('Eren Yeager','https://i.pinimg.com/1200x/3c/cc/1d/3ccc1dc40eb3a8310994e512b0583210.jpg','–§–∏–≥—É—Ä–∫–∞ –≠—Ä–µ–Ω–∞ –ô–µ–≥–µ—Ä–∞ –∏–∑ ¬´–ê—Ç–∞–∫–∏ —Ç–∏—Ç–∞–Ω–æ–≤¬ª.','3000 ‚ÇΩ')">
          <img src="https://i.pinimg.com/1200x/3c/cc/1d/3ccc1dc40eb3a8310994e512b0583210.jpg" alt="Eren Yeager">
          <h3>Eren Yeager</h3><p>–¶–µ–Ω–∞: 3000 ‚ÇΩ</p>
        </div>

        <div class="card" onclick="openProduct('Itachi Uchiha','https://i.pinimg.com/1200x/0d/7c/fb/0d7cfbc983aad8c520c335c04f85e40c.jpg','–§–∏–≥—É—Ä–∫–∞ –ò—Ç–∞—á–∏ –£—á–∏—Ö–∏ –∏–∑ –∞–Ω–∏–º–µ Naruto Shippuden.','3100 ‚ÇΩ')">
          <img src="https://i.pinimg.com/1200x/0d/7c/fb/0d7cfbc983aad8c520c335c04f85e40c.jpg" alt="Itachi">
          <h3>Itachi Uchiha</h3><p>–¶–µ–Ω–∞: 3100 ‚ÇΩ</p>
        </div>

        <div class="card" onclick="openProduct('Levi Ackerman','https://i.pinimg.com/736x/dc/31/a9/dc31a95682b372be65164c47d6ca9060.jpg','–§–∏–≥—É—Ä–∫–∞ –õ–µ–≤–∏ –ê–∫–∫–µ—Ä–º–∞–Ω–∞ –∏–∑ ¬´–ê—Ç–∞–∫–∏ —Ç–∏—Ç–∞–Ω–æ–≤¬ª.','3300 ‚ÇΩ')">
          <img src="https://i.pinimg.com/736x/dc/31/a9/dc31a95682b372be65164c47d6ca9060.jpg" alt="Levi">
          <h3>Levi Ackerman</h3><p>–¶–µ–Ω–∞: 3300 ‚ÇΩ</p>
        </div>
        <div class="card" onclick="openProduct('Tanjiro Kamado','https://i.pinimg.com/736x/cd/6b/ed/cd6bed44912f6d01189da464e11d90fe.jpg','–§–∏–≥—É—Ä–∫–∞ –¢–∞–Ω–¥–∂–∏—Ä–æ –ö–∞–º–∞–¥–æ –∏–∑ Demon Slayer.','2700 ‚ÇΩ')">
    <img src="https://i.pinimg.com/736x/cd/6b/ed/cd6bed44912f6d01189da464e11d90fe.jpg" alt="Tanjiro Kamado">
    <h3>Tanjiro Kamado</h3><p>–¶–µ–Ω–∞: 2700 ‚ÇΩ</p>
  </div>
    <div class="card" onclick="openProduct('Light Yagami','https://i.pinimg.com/736x/5f/9e/8e/5f9e8e6d640ee6f680098dd71336acda.jpg','–§–∏–≥—É—Ä–∫–∞ –õ–∞–π—Ç–∞ –Ø–≥–∞–º–∏ –∏–∑ Death Note.','2800 ‚ÇΩ')">
    <img src="https://i.pinimg.com/736x/5f/9e/8e/5f9e8e6d640ee6f680098dd71336acda.jpg" alt="Light Yagami">
    <h3>Light Yagami</h3><p>–¶–µ–Ω–∞: 2800 ‚ÇΩ</p>
  </div>
  <div class="card" onclick="openProduct('Ichigo Kurosaki','https://i.pinimg.com/1200x/53/a0/2b/53a02bd11cb9b23d16fefd50084b2712.jpg','–§–∏–≥—É—Ä–∫–∞ –ò—á–∏–≥–æ –ö—É—Ä–æ—Å–∞–∫–∏ –∏–∑ Bleach.','3200 ‚ÇΩ')">
    <img src="https://i.pinimg.com/1200x/53/a0/2b/53a02bd11cb9b23d16fefd50084b2712.jpg" alt="Ichigo Kurosaki">
    <h3>Ichigo Kurosaki</h3><p>–¶–µ–Ω–∞: 3200 ‚ÇΩ</p>
  </div>


      </div>
    </div>

    <!-- PRODUCT -->
    <div id="product" class="page">
      <h2>–ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞</h2>
      <img id="product-img" src="" alt="–¢–æ–≤–∞—Ä">
      <h3 id="product-title"></h3>
      <p id="product-desc"></p>
      <p><b>–¶–µ–Ω–∞:</b> <span id="product-price"></span></p>
      <button class="btn" onclick="addToCart()">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
      <button class="btn ghost" onclick="showPage('catalogPage')" style="margin-left:10px;">–ù–∞–∑–∞–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥</button>
    </div>

    <!-- CART -->
    <div id="cart" class="page">
      <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
      <ul id="cart-list"></ul>
      <p><b>–ò—Ç–æ–≥–æ:</b> <span id="total-price">0 ‚ÇΩ</span></p>

      <div class="cart-actions">
        <button class="btn ghost" onclick="clearCart()">–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
        <button class="btn" onclick="openPay()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
      </div>
    </div>

    <!-- ORDERS -->
    <div id="orders" class="page">
      <h2>–ú–æ–∏ –∑–∞–∫–∞–∑—ã</h2>
      <p style="opacity:.8;">–ó–∞–∫–∞–∑—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ (localStorage).</p>

      <div id="ordersList"></div>

      <button class="btn ghost" type="button" onclick="clearOrders()">–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
    </div>

    <!-- ABOUT -->
    <div id="about" class="page">
      <h2>–û –Ω–∞—Å</h2>
      <p><b>Anime Store</b> ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω, –∞ –º–µ—Å—Ç–æ, —Å–æ–∑–¥–∞–Ω–Ω–æ–µ —Ñ–∞–Ω–∞—Ç–∞–º–∏ –∞–Ω–∏–º–µ –¥–ª—è —Ñ–∞–Ω–∞—Ç–æ–≤ –∞–Ω–∏–º–µ.</p>
      <p>–ù–∞—à–∞ –∏–¥–µ—è –ø—Ä–æ—Å—Ç–∞ ‚Äî <b>–¥–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–º—É –ø–æ–∫–ª–æ–Ω–Ω–∏–∫—É —è–ø–æ–Ω—Å–∫–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏–∫–æ—Å–Ω—É—Ç—å—Å—è –∫ –ª—é–±–∏–º—ã–º –≥–µ—Ä–æ—è–º –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏</b>.</p>

      <h3>–ß—Ç–æ –¥–ª—è –Ω–∞—Å –≤–∞–∂–Ω–æ</h3>
      <ul>
        <li><b>–ö–∞—á–µ—Å—Ç–≤–æ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ –ø–æ–∫—Ä–∞—Å–∫–∏</b></li>
        <li><b>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è</b></li>
        <li><b>–ù–∞–¥—ë–∂–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞</b></li>
      </ul>

      <h3>–ù–∞—à–∞ —Ü–µ–ª—å</h3>
      <p><b>–î–æ–≤–æ–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã</b>. –ú—ã –¥–µ–ª–∞–µ–º –ø–æ–∫—É–ø–∫—É –ø—Ä–æ—Å—Ç–æ–π –∏ –ø—Ä–∏—è—Ç–Ω–æ–π üíñ</p>
    </div>
  </div>

  <footer>
    <p>¬©2026 Anime Store</p>
  </footer>

  <!-- PAY MODAL -->
  <div id="payOverlay" class="overlay" style="z-index:10001;">
    <div class="modalBox">
      <div class="modalHeader">
        <div>
          <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
          <small>–î–æ—Å—Ç–∞–≤–∫–∞ + —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</small>
        </div>
        <button class="btn ghost" type="button" onclick="closePay()">‚úï</button>
      </div>

      <div class="sumBox">
        <div class="sumLine"><span>–¢–æ–≤–∞—Ä—ã:</span> <b id="sumGoods">0 ‚ÇΩ</b></div>
        <div class="sumLine"><span>–î–æ—Å—Ç–∞–≤–∫–∞:</span> <b id="sumDelivery">0 ‚ÇΩ</b></div>
        <div class="sumLine"><span>–°–∫–∏–¥–∫–∞:</span> <b id="sumDiscount">0 ‚ÇΩ</b></div>
        <hr style="opacity:.2;">
        <div class="sumLine"><span>–ò—Ç–æ–≥–æ:</span> <b id="sumFinal">0 ‚ÇΩ</b></div>
      </div>

      <!-- Delivery -->
      <div class="row">
        <label>–î–æ—Å—Ç–∞–≤–∫–∞</label>
        <div class="chips">
          <label class="chip">
            <input type="radio" name="delivery" value="courier" checked onchange="renderDeliveryUI()">
            <span>–ö—É—Ä—å–µ—Ä (+ <span id="deliveryFeeLabel">200 ‚ÇΩ</span>)</span>
          </label>
          <label class="chip">
            <input type="radio" name="delivery" value="pickup" onchange="renderDeliveryUI()">
            <span>–°–∞–º–æ–≤—ã–≤–æ–∑ (0 ‚ÇΩ)</span>
          </label>
        </div>
      </div>

      <div id="deliveryForm">
        <div class="row">
          <label for="receiver">–ü–æ–ª—É—á–∞—Ç–µ–ª—å</label>
          <input id="receiver" type="text" placeholder="–ò–º—è –ø–æ–ª—É—á–∞—Ç–µ–ª—è">
        </div>

        <div class="row" id="addressRow">
          <label for="address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</label>
          <input id="address" type="text" placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞">
        </div>

        <div class="row">
          <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
          <input id="phone" type="text" inputmode="tel" placeholder="+996 700 000 000">
        </div>

        <div class="row">
          <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫—É—Ä—å–µ—Ä—É</label>
          <input id="comment" type="text" placeholder="–î–æ–º–æ—Ñ–æ–Ω, –ø–æ–¥—ä–µ–∑–¥, —ç—Ç–∞–∂, –ø—Ä–∏–º–µ—á–∞–Ω–∏—è">
        </div>
      </div>

      <!-- Promo -->
      <div class="row">
        <label for="promo">–ü—Ä–æ–º–æ–∫–æ–¥</label>
        <div style="display:flex; gap:10px;">
          <input id="promo" type="text" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: ANIME10">
          <button class="btn ghost" type="button" onclick="applyPromo()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
        <div class="hint" id="promoHint">–î–µ–º–æ-–∫–æ–¥—ã: ANIME10 (-10%), FREEDEL (–¥–æ—Å—Ç–∞–≤–∫–∞ 0‚ÇΩ)</div>
      </div>

      <!-- Payment method -->
      <div class="row">
        <label>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</label>
        <div class="chips">
          <label class="chip">
            <input type="radio" name="payMethod" value="card" checked onchange="renderPayMethodUI()">
            <span>–ö–∞—Ä—Ç–æ–π</span>
          </label>
          <label class="chip">
            <input type="radio" name="payMethod" value="cod" onchange="renderPayMethodUI()">
            <span>–û–ø–ª–∞—Ç–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</span>
          </label>
        </div>
      </div>

      <!-- Saved cards -->
      <div class="row" id="savedMethodsRow">
        <label>–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã</label>
        <select id="savedCards" onchange="fillFromSavedCard()"></select>
        <div class="hint">–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é –∫–∞—Ä—Ç—É –∏–ª–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –Ω–æ–≤—É—é.</div>
      </div>

      <!-- Card form -->
      <div id="cardForm">
        <div class="grid2">
          <div class="row">
            <label for="cardName">–ò–º—è –Ω–∞ –∫–∞—Ä—Ç–µ</label>
            <input id="cardName" type="text" placeholder="IVAN IVANOV">
          </div>
          <div class="row">
            <label for="cardNumber">–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã</label>
            <input id="cardNumber" type="text" inputmode="numeric" placeholder="0000 0000 0000 0000" maxlength="19">
          </div>
          <div class="row">
            <label for="cardExp">–°—Ä–æ–∫ (MM/YY)</label>
            <input id="cardExp" type="text" inputmode="numeric" placeholder="12/30" maxlength="5">
          </div>
          <div class="row">
            <label for="cardCvv">CVV</label>
            <input id="cardCvv" type="password" inputmode="numeric" placeholder="123" maxlength="3">
          </div>
        </div>
        <div class="row">
          <label style="display:flex; gap:10px; align-items:center;">
            <input id="saveCard" type="checkbox" style="width:auto;">
            <span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Ä—Ç—É –¥–ª—è –±—É–¥—É—â–∏—Ö –ø–æ–∫—É–ø–æ–∫</span>
          </label>
        </div>
      </div>

      <div id="payError" class="error">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.</div>

      <div class="actions">
        <button class="btn ghost" type="button" onclick="closePay()">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn" type="button" onclick="confirmPay()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
      </div>

      <div class="hint">*–≠—Ç–æ –¥–µ–º–æ-–æ–ø–ª–∞—Ç–∞. –î–µ–Ω—å–≥–∏ –Ω–∏–∫—É–¥–∞ –Ω–µ —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è.</div>
    </div>
  </div>

  <script>
    /* =======================
       Tabs + scroll fix
    ======================== */
    function showPage(pageId){
      document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
      document.getElementById(pageId).classList.add("active");

      document.querySelectorAll("nav button").forEach(b => b.classList.remove("activeTab"));
      const btn = document.querySelector(`nav button[onclick="showPage('${pageId}')"]`);
      if (btn) btn.classList.add("activeTab");

      window.scrollTo({ top: 0, left: 0, behavior: "instant" });
      if (pageId === "orders") renderOrders();
    }

    /* =======================
       Cart
    ======================== */
    let cart = [];
    let currentProduct = null;

    function openProduct(title, img, desc, price){
      document.getElementById("product-title").innerText = title;
      document.getElementById("product-img").src = img;
      document.getElementById("product-desc").innerText = desc;
      document.getElementById("product-price").innerText = price;
      currentProduct = { title, price };
      showPage("product");
      window.scrollTo(0,0);
    }

    function addToCart(){
      if (!currentProduct) return;
      cart.push(currentProduct);
      updateCart();
      alert("–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!");
    }

    function removeCartItem(index){
      cart.splice(index, 1);
      updateCart();
    }

    function updateCart(){
      const list = document.getElementById("cart-list");
      const total = document.getElementById("total-price");
      list.innerHTML = "";

      if (!cart.length){
        list.innerHTML = "<li>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞.</li>";
        total.textContent = "0 ‚ÇΩ";
        return;
      }

      let sum = 0;
      cart.forEach((item, idx) => {
        const li = document.createElement("li");
        li.innerHTML = `
          <span>${item.title} ‚Äî ${item.price}</span>
          <button class="removeItemBtn" type="button" onclick="removeCartItem(${idx})">–£–¥–∞–ª–∏—Ç—å</button>
        `;
        list.appendChild(li);
        sum += parseInt(item.price, 10);
      });

      total.textContent = sum + " ‚ÇΩ";
    }

    function clearCart(){
      cart = [];
      updateCart();
    }

    window.openProduct = openProduct;
    window.addToCart = addToCart;
    window.removeCartItem = removeCartItem;
    window.clearCart = clearCart;

    /* =======================
       Loader (1 —Ä–∞–∑)
    ======================== */
    document.body.style.overflow = "hidden";
    window.addEventListener("load", () => {
      setTimeout(() => {
        document.getElementById("loader").classList.add("hide");
        document.body.style.overflow = "auto";
      }, 900);
    });

    /* =======================
       Accent themes
    ======================== */
    const THEMES = {
      red:    { accent: "#ef4444", accent2: "#dc2626" },
      blue:   { accent: "#3b82f6", accent2: "#2563eb" },
      orange: { accent: "#f97316", accent2: "#ea580c" },
      purple: { accent: "#8b5cf6", accent2: "#7c3aed" },
    };

    function applyTheme(name){
      const t = THEMES[name] || THEMES.purple;
      document.documentElement.style.setProperty("--accent", t.accent);
      document.documentElement.style.setProperty("--accent-2", t.accent2);
    }

    function setTheme(name){
      localStorage.setItem("theme", name);
      applyTheme(name);
    }
    window.setTheme = setTheme;

    /* =======================
       Light/Dark
    ======================== */
    function toggleMode(){
      const isDark = document.body.classList.toggle("dark");
      document.body.classList.toggle("light", !isDark);
      localStorage.setItem("mode", isDark ? "dark" : "light");
      updateModeIcon();
    }

    function updateModeIcon(){
      const btn = document.querySelector(".mode-btn");
      if (!btn) return;
      btn.textContent = document.body.classList.contains("dark") ? "‚òÄ" : "üåô";
    }
    window.toggleMode = toggleMode;

    /* =======================
       Auth (demo)
    ======================== */
    const AUTH_USERS = [
      { login: "admin", pass: "1234" },
      { login: "matew", pass: "0000" },
    ];

    function showAuth(show){
      const ov = document.getElementById("authOverlay");
      ov.classList.toggle("show", !!show);
      document.body.style.overflow = show ? "hidden" : "auto";
    }

    function setAuthState(isAuthed, login){
      sessionStorage.setItem("isAuthed", isAuthed ? "1" : "0");
      sessionStorage.setItem("authLogin", login || "");
    }

    function login(){
      const loginEl = document.getElementById("authLogin");
      const passEl  = document.getElementById("authPass");
      const err     = document.getElementById("authError");

      const l = (loginEl.value || "").trim();
      const p = (passEl.value || "").trim();

      const ok = AUTH_USERS.some(u => u.login === l && u.pass === p);
      if (!ok){
        err.classList.add("show");
        setAuthState(false, "");
        return;
      }

      err.classList.remove("show");
      setAuthState(true, l);
      showAuth(false);
    }

    function logout(){
      setAuthState(false, "");
      showAuth(true);
    }

    function fillDemo(){
      document.getElementById("authLogin").value = "admin";
      document.getElementById("authPass").value  = "1234";
    }

    window.login = login;
    window.logout = logout;
    window.fillDemo = fillDemo;

    function bootAuth(){
      const isAuthed = sessionStorage.getItem("isAuthed") === "1";
      showAuth(!isAuthed);
    }

    /* =======================
       Pay + Promo + Saved cards
    ======================== */
    const STORAGE_CARDS_KEY = "savedCards";
    const STORAGE_PREF_METHOD = "preferredPayMethod";
    const STORAGE_PREF_DELIVERY = "preferredDelivery";
    const ORDERS_KEY = "ordersHistory";

    let promoState = { code: "", discountPercent: 0, freeDelivery: false };

    function getSavedCards(){
      try { return JSON.parse(localStorage.getItem(STORAGE_CARDS_KEY) || "[]"); }
      catch { return []; }
    }
    function setSavedCards(cards){
      localStorage.setItem(STORAGE_CARDS_KEY, JSON.stringify(cards));
    }

    function getOrders(){
      try { return JSON.parse(localStorage.getItem(ORDERS_KEY) || "[]"); }
      catch { return []; }
    }
    function setOrders(list){
      localStorage.setItem(ORDERS_KEY, JSON.stringify(list));
    }

    function getPayMethod(){
      return document.querySelector('input[name="payMethod"]:checked')?.value || "card";
    }
    function getDelivery(){
      return document.querySelector('input[name="delivery"]:checked')?.value || "courier";
    }

    function calcGoodsSum(){
      return cart.reduce((s, i) => s + parseInt(i.price, 10), 0);
    }
    function deliveryFee(){
      return getDelivery() === "courier" ? 200 : 0;
    }
    function calcDiscount(goods){
      return Math.round(goods * (promoState.discountPercent / 100));
    }

    function updatePaySummary(){
      const goods = calcGoodsSum();
      const delBase = deliveryFee();
      const del = promoState.freeDelivery ? 0 : delBase;
      const disc = calcDiscount(goods);
      const final = Math.max(0, goods + del - disc);

      const rub = n => `${n} ‚ÇΩ`;
      document.getElementById("sumGoods").textContent = rub(goods);
      document.getElementById("sumDelivery").textContent = rub(del);
      document.getElementById("sumDiscount").textContent = disc ? `- ${rub(disc)}` : "0 ‚ÇΩ";
      document.getElementById("sumFinal").textContent = rub(final);

      document.getElementById("deliveryFeeLabel").textContent = promoState.freeDelivery ? "0 ‚ÇΩ" : "200 ‚ÇΩ";
    }

    function populateSavedCards(){
      const sel = document.getElementById("savedCards");
      const cards = getSavedCards();
      sel.innerHTML = "";

      const opt0 = document.createElement("option");
      opt0.value = "";
      opt0.textContent = cards.length ? "‚Äî –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç—É ‚Äî" : "‚Äî –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∫–∞—Ä—Ç ‚Äî";
      sel.appendChild(opt0);

      cards.forEach((c, idx) => {
        const opt = document.createElement("option");
        opt.value = String(idx);
        opt.textContent = `${c.brand} ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ${c.last4} (${c.name})`;
        sel.appendChild(opt);
      });
    }

    function fillFromSavedCard(){
      const sel = document.getElementById("savedCards");
      const idx = Number(sel.value);
      const cards = getSavedCards();
      if (!Number.isFinite(idx) || !cards[idx]) return;

      const c = cards[idx];
      document.getElementById("cardName").value = c.name;
      document.getElementById("cardNumber").value = c.masked;
      document.getElementById("cardExp").value = c.exp;
      document.getElementById("cardCvv").value = "";
      document.getElementById("saveCard").checked = false;
    }
    window.fillFromSavedCard = fillFromSavedCard;

    function renderPayMethodUI(){
      const method = getPayMethod();
      localStorage.setItem(STORAGE_PREF_METHOD, method);

      const showCard = method === "card";
      document.getElementById("cardForm").style.display = showCard ? "" : "none";
      document.getElementById("savedMethodsRow").style.display = showCard ? "" : "none";

      updatePaySummary();
    }
    window.renderPayMethodUI = renderPayMethodUI;

    function renderDeliveryUI(){
      const d = getDelivery();
      localStorage.setItem(STORAGE_PREF_DELIVERY, d);

      document.getElementById("addressRow").style.display = (d === "courier") ? "" : "none";
      updatePaySummary();
    }
    window.renderDeliveryUI = renderDeliveryUI;

    function openPay(){
      if (!cart.length){
        alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –ø–µ—Ä–µ–¥ –æ–ø–ª–∞—Ç–æ–π.");
        return;
      }

      promoState = { code: "", discountPercent: 0, freeDelivery: false };
      document.getElementById("promo").value = "";
      document.getElementById("promoHint").textContent = "–î–µ–º–æ-–∫–æ–¥—ã: ANIME10 (-10%), FREEDEL (–¥–æ—Å—Ç–∞–≤–∫–∞ 0‚ÇΩ)";

      // prefs
      const prefPay = localStorage.getItem(STORAGE_PREF_METHOD) || "card";
      const payRadio = document.querySelector(`input[name="payMethod"][value="${prefPay}"]`);
      if (payRadio) payRadio.checked = true;

      const prefDel = localStorage.getItem(STORAGE_PREF_DELIVERY) || "courier";
      const delRadio = document.querySelector(`input[name="delivery"][value="${prefDel}"]`);
      if (delRadio) delRadio.checked = true;

      populateSavedCards();
      renderPayMethodUI();
      renderDeliveryUI();
      updatePaySummary();

      document.getElementById("payError").classList.remove("show");
      document.getElementById("payOverlay").classList.add("show");
      document.body.style.overflow = "hidden";
    }

    function closePay(){
      document.getElementById("payOverlay").classList.remove("show");
      document.body.style.overflow = "auto";
    }

    window.openPay = openPay;
    window.closePay = closePay;

    function applyPromo(){
      const v = (document.getElementById("promo").value || "").trim().toUpperCase();
      const hint = document.getElementById("promoHint");

      if (v === "ANIME10"){
        promoState = { code: v, discountPercent: 10, freeDelivery: false };
        hint.textContent = "‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ ANIME10 –ø—Ä–∏–º–µ–Ω—ë–Ω: —Å–∫–∏–¥–∫–∞ -10% –Ω–∞ —Ç–æ–≤–∞—Ä—ã.";
      } else if (v === "FREEDEL"){
        promoState = { code: v, discountPercent: 0, freeDelivery: true };
        hint.textContent = "‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ FREEDEL –ø—Ä–∏–º–µ–Ω—ë–Ω: –¥–æ—Å—Ç–∞–≤–∫–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ.";
      } else if (!v){
        promoState = { code: "", discountPercent: 0, freeDelivery: false };
        hint.textContent = "–î–µ–º–æ-–∫–æ–¥—ã: ANIME10 (-10%), FREEDEL (–¥–æ—Å—Ç–∞–≤–∫–∞ 0‚ÇΩ)";
      } else {
        promoState = { code: "", discountPercent: 0, freeDelivery: false };
        hint.textContent = "‚ùå –¢–∞–∫–æ–π –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω (–¥–µ–º–æ: ANIME10, FREEDEL).";
      }
      updatePaySummary();
    }
    window.applyPromo = applyPromo;

    function formatCardNumber(value){
      const digits = value.replace(/\D/g, "").slice(0,16);
      return digits.replace(/(.{4})/g, "$1 ").trim();
    }
    function formatExp(value){
      const digits = value.replace(/\D/g, "").slice(0,4);
      if (digits.length <= 2) return digits;
      return digits.slice(0,2) + "/" + digits.slice(2);
    }

    function validateCard(){
      const name = document.getElementById("cardName").value.trim();
      const numRaw = document.getElementById("cardNumber").value.replace(/\s/g,"");
      const exp = document.getElementById("cardExp").value.trim();
      const cvv = document.getElementById("cardCvv").value.trim();

      if (name.length < 3) return false;
      if (!/^\d{16}$/.test(numRaw)) return false;
      if (!/^\d{2}\/\d{2}$/.test(exp)) return false;
      if (!/^\d{3}$/.test(cvv)) return false;

      const [mm, yy] = exp.split("/").map(x => parseInt(x,10));
      if (mm < 1 || mm > 12) return false;

      const now = new Date();
      const curYY = now.getFullYear() % 100;
      const curMM = now.getMonth() + 1;

      if (yy < curYY) return false;
      if (yy === curYY && mm < curMM) return false;

      return true;
    }

    function validateDelivery(){
      const receiver = document.getElementById("receiver").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const d = getDelivery();
      const address = document.getElementById("address").value.trim();

      if (receiver.length < 2) return false;
      if (phone.length < 8) return false;
      if (d === "courier" && address.length < 8) return false;
      return true;
    }

    function detectBrand(numRaw){
      if (numRaw.startsWith("4")) return "VISA";
      if (/^5[1-5]/.test(numRaw)) return "Mastercard";
      if (numRaw.startsWith("2")) return "–ú–ò–†";
      return "–ö–∞—Ä—Ç–∞";
    }

    function saveCardIfNeeded(){
      const wantSave = document.getElementById("saveCard").checked;
      if (!wantSave) return;

      const name = document.getElementById("cardName").value.trim();
      const numRaw = document.getElementById("cardNumber").value.replace(/\s/g,"");
      const exp = document.getElementById("cardExp").value.trim();

      const last4 = numRaw.slice(-4);
      const brand = detectBrand(numRaw);
      const masked = "‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ " + last4;

      const cards = getSavedCards();
      const exists = cards.some(c => c.last4 === last4 && c.exp === exp && c.name === name);
      if (exists) return;

      cards.push({ name, last4, exp, brand, masked });
      setSavedCards(cards);
    }

    function confirmPay(){
      const err = document.getElementById("payError");
      err.classList.remove("show");

      if (!validateDelivery()){
        err.textContent = "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è/—Ç–µ–ª–µ—Ñ–æ–Ω/–∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏.";
        err.classList.add("show");
        return;
      }

      const method = getPayMethod();
      if (method === "card"){
        if (!validateCard()){
          err.textContent = "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã (–Ω–æ–º–µ—Ä/—Å—Ä–æ–∫/CVV).";
          err.classList.add("show");
          return;
        }
        saveCardIfNeeded();
      }

      const goods = calcGoodsSum();
      const delBase = deliveryFee();
      const del = promoState.freeDelivery ? 0 : delBase;
      const disc = calcDiscount(goods);
      const final = Math.max(0, goods + del - disc);

      const payMethodText = (method === "card") ? "–ö–∞—Ä—Ç–æ–π" : "–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏";
      const deliveryText = (getDelivery() === "courier") ? "–ö—É—Ä—å–µ—Ä" : "–°–∞–º–æ–≤—ã–≤–æ–∑";

      const receiver = document.getElementById("receiver").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const address = (getDelivery() === "courier") ? document.getElementById("address").value.trim() : "";
      const comment = document.getElementById("comment").value.trim();

      const order = {
        id: String(Date.now()).slice(-6),
        date: new Date().toLocaleString(),
        items: cart.map(x => ({ title: x.title, price: x.price })),
        payMethod: payMethodText,
        delivery: deliveryText,
        receiver,
        phone,
        address,
        comment,
        promo: promoState.code || "",
        total: `${final} ‚ÇΩ`
      };

      const orders = getOrders();
      orders.push(order);
      setOrders(orders);

      closePay();

      setTimeout(() => {
        alert(`‚úÖ –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!\n–û–ø–ª–∞—Ç–∞: ${payMethodText}\n–î–æ—Å—Ç–∞–≤–∫–∞: ${deliveryText}\n–°—É–º–º–∞: ${final} ‚ÇΩ\n\n–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É üíñ`);
        clearCart();
        renderOrders();
        showPage("orders");
      }, 250);
    }
    window.confirmPay = confirmPay;

    window.addEventListener("input", (e) => {
      if (e.target && e.target.id === "cardNumber"){
        const raw = e.target.value.replace(/\s/g,"");
        if (raw.includes("‚Ä¢")) return;
        e.target.value = formatCardNumber(e.target.value);
      }
      if (e.target && e.target.id === "cardExp"){
        e.target.value = formatExp(e.target.value);
      }
    });

    /* =======================
       Orders render + delete ONE order ‚úÖ
    ======================== */
    function renderOrders(){
      const wrap = document.getElementById("ordersList");
      const orders = getOrders();

      if (!orders.length){
        wrap.innerHTML = `<div class="orderCard">–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤.</div>`;
        return;
      }

      // newest first
      const view = orders.slice().reverse();

      wrap.innerHTML = view.map(o => {
        const itemsText = o.items.map(i => `‚Ä¢ ${i.title} ‚Äî ${i.price}`).join("<br>");
        return `
          <div class="orderCard">
            <div class="orderHead">
              <div>
                <b>–ó–∞–∫–∞–∑ #${o.id}</b>
                <div style="opacity:.75;font-size:12px;margin-top:4px;">${o.date}</div>
              </div>
              <div><b>${o.total}</b></div>
            </div>

            <div class="orderItems">${itemsText}</div>

            <div class="orderMeta">
              <div><b>–û–ø–ª–∞—Ç–∞:</b> ${o.payMethod}</div>
              <div><b>–î–æ—Å—Ç–∞–≤–∫–∞:</b> ${o.delivery}</div>
              <div><b>–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</b> ${o.receiver}</div>
              <div><b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> ${o.phone}</div>
              ${o.address ? `<div><b>–ê–¥—Ä–µ—Å:</b> ${o.address}</div>` : `<div><b>–ê–¥—Ä–µ—Å:</b> —Å–∞–º–æ–≤—ã–≤–æ–∑</div>`}
              ${o.comment ? `<div><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> ${o.comment}</div>` : ""}
              ${o.promo ? `<div><b>–ü—Ä–æ–º–æ–∫–æ–¥:</b> ${o.promo}</div>` : ""}
            </div>

            <div class="orderActions">
              <button class="btn dangerBtn" type="button" onclick="deleteOrder('${o.id}')">–£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑</button>
            </div>
          </div>
        `;
      }).join("");
    }

    function deleteOrder(orderId){
      if (!confirm(`–£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑ #${orderId}?`)) return;
      const orders = getOrders();
      const next = orders.filter(o => o.id !== orderId);
      setOrders(next);
      renderOrders();
    }

    function clearOrders(){
      if (!confirm("–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤?")) return;
      setOrders([]);
      renderOrders();
    }

    window.deleteOrder = deleteOrder;
    window.clearOrders = clearOrders;

    /* =======================
       Boot
    ======================== */
    (function init(){
      // theme accent
      applyTheme(localStorage.getItem("theme") || "purple");

      // mode
      const mode = localStorage.getItem("mode") || "dark";
      document.body.classList.add(mode);
      document.body.classList.toggle("light", mode === "light");
      document.body.classList.toggle("dark", mode === "dark");
      updateModeIcon();

      // auth
      bootAuth();

      // initial cart render
      updateCart();
    })();
  </script>
</body>
</html>
